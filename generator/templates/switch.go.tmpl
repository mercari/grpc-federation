{{- define "declSwitch" }}
	{{- $switch := .Switch }}
	{{- $cases := $switch.Cases }}
	cases := []*grpcfed.EvalSwitchCase[*localValueType]{}
	{{- range $cases }}
	cases = append(cases, &grpcfed.EvalSwitchCase[*localValueType]{
	    {{- if .DefSet }}
		Defs: func(ctx context.Context, value *localValueType) (any, error) {
			{{- template "evalDefSet" .DefSet }}
            return nil, nil
		},
		{{- end }}
		If: `{{ .If.Expr }}`,
		IfCacheIndex: {{ $switch.CELCacheIndex }},
		By: `{{ .By.Expr }}`,
		ByCacheIndex: {{ $switch.CELCacheIndex }},
	})
	{{- end }}
	return grpcfed.EvalSwitch[{{ .Type }}](ctx, value, cases, &grpcfed.EvalSwitchDefault[*localValueType]{
		{{- if $switch.Default.DefSet }}
		Defs: func(ctx context.Context, value *localValueType) (any, error) {
			{{- template "evalDefSet" $switch.Default.DefSet }}
			return nil, nil
		},
		{{- end }}
		By: `{{ $switch.Default.By.Expr }}`,
		ByCacheIndex: {{ $switch.CELCacheIndex }},
	})
{{- end }}